{
  "$jsonSchema": {
    "bsonType": "object",
    "title": "orders collection schema",
    "required": [
      "orderNumber",
      "userId",
      "status",
      "orderDate",
      "items",
      "payment",
      "shippingAddress",
      "totals",
      "updatedAt"
    ],
    "properties": {
      "_id": {
        "bsonType": "objectId"
      },
      "orderNumber": {
        "bsonType": "string"
      },
      "userId": {
        "bsonType": "objectId"
      },
      "status": {
        "enum": ["pending", "paid", "shipped", "delivered", "cancelled"]
      },
      "orderDate": {
        "bsonType": "date"
      },
      "items": {
        "bsonType": "array",
        "minItems": 1,
        "items": {
          "bsonType": "object",
          "required": [
            "productId",
            "sku",
            "name",
            "unitPrice",
            "quantity",
            "lineTotal"
          ],
          "properties": {
            "productId": { "bsonType": "objectId" },
            "sku": { "bsonType": "string" },
            "name": { "bsonType": "string" },
            "unitPrice": { "bsonType": "decimal" },
            "quantity": { "bsonType": "int", "minimum": 1 },
            "lineTotal": { "bsonType": "decimal" }
          }
        }
      },
      "payment": {
        "bsonType": "object",
        "required": ["method", "status"],
        "properties": {
          "method": { "enum": ["card", "wallet", "cod", "upi"] },
          "transactionId": { "bsonType": ["string", "null"] },
          "status": { "enum": ["pending", "authorized", "captured", "failed", "refunded"] }
        }
      },
      "shippingAddress": {
        "bsonType": "object",
        "required": ["name", "line1", "city", "postalCode", "country"],
        "properties": {
          "name": { "bsonType": "string" },
          "line1": { "bsonType": "string" },
          "line2": { "bsonType": ["string", "null"] },
          "city": { "bsonType": "string" },
          "state": { "bsonType": ["string", "null"] },
          "postalCode": { "bsonType": "string" },
          "country": { "bsonType": "string", "minLength": 2, "maxLength": 2 }
        }
      },
      "totals": {
        "bsonType": "object",
        "required": ["subtotal", "tax", "shipping", "discount", "grandTotal"],
        "properties": {
          "subtotal": { "bsonType": "decimal" },
          "tax": { "bsonType": "decimal" },
          "shipping": { "bsonType": "decimal" },
          "discount": { "bsonType": "decimal" },
          "grandTotal": { "bsonType": "decimal" }
        }
      },
      "notes": {
        "bsonType": ["string", "null"]
      },
      "updatedAt": {
        "bsonType": "date"
      }
    }
  }
}
